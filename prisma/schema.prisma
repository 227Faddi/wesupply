generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          Int              @id @default(autoincrement())
  email       String           @unique
  name        String?
  age         Int?
  createdAt   DateTime         @default(now())
  height      Int?
  weight      Int?
  authId      String?          @unique
  mealPlans   MealPlan[]
  preferences UserPreferences?
}

model UserPreferences {
  id                  Int      @id @default(autoincrement())
  weeklyBudget        Float
  dailyCalories       Int
  dietaryRestrictions String[]
  allergens           String[]
  userId              Int      @unique
  user                User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MealPlan {
  id        Int           @id @default(autoincrement())
  title     String
  startDate DateTime
  createdAt DateTime      @default(now())
  userId    Int
  totalCost Float         @default(0)
  user      User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  meals     PlannedMeal[]
}

model PlannedMeal {
  id         Int      @id @default(autoincrement())
  mealType   String
  mealPlanId Int
  recipeId   Int
  dayOfWeek  String
  weekNumber Int
  mealPlan   MealPlan @relation(fields: [mealPlanId], references: [id], onDelete: Cascade)
  recipe     Recipe   @relation(fields: [recipeId], references: [id])
}

model Recipe {
  id             Int           @id @default(autoincrement())
  name           String
  imageUrl       String?
  prepTime       Int
  servings       Int
  instructions   String
  calories       Int
  protein        Int
  carbs          Int
  fats           Int
  ingredients    String
  costPerServing Float
  totalCost      Float
  meals          PlannedMeal[]
}
